@using Drive.Security;

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

<h3>Hello @SessionManager.User.Name</h3>

<h4>Folders</h4>

<div id="folders">

</div>
@*@{
        if (ViewBag.folders != null)
        {
            foreach (var folder in ViewBag.folders)
            {
                <div style="border: 5px solid black; clear: both">
                    ID: @folder.Id <br />
                    Name: @folder.Name <br />
                    CreatedOn: @folder.CreatedOn <br />
                </div>
            }
        }
        else
        {
            <span style="color: red">NO FOLDERS</span><br />
        }

    }*@

<h4>Files</h4>

@{
    if (ViewBag.files != null)
    {
        foreach (var file in ViewBag.files)
        {
            <div style="border: 5px solid black;">
                ID: @file.Id <br />
                Name: @file.Name <br />
                UploadedOn: @file.UploadedOn <br />
                Size: @file.FileSizeInKB <br />
                Extension: @file.FileExt <br />
            </div>
        }
    }
    else
    {
        <span style="color: red">NO FILES</span><br />
    }
}

@section scripts {
    @Scripts.Render("~/bundles/uglipop")

    <script>

        //Load folders on page load
        $(document).ready(function () {
            Folder.getFoldersFromServer();
        });

        //prompt to add new folder
        var promptNewFolder = function () {
            uglipop({ class: 'prompt', source: 'div', content: 'add-new-folder-popup' });
        }

        $("button[name=new-folder]").click(function () { promptNewFolder(); });

        //Register click event to go to a folder
        $(document).on("dblclick", ".folder", function () {
            currentFolderId = $(this).attr("folder-id");
            Folder.getFoldersFromServer();
        });

    </script>

    <div id="add-new-folder-popup" style="display:none;">
        <h5>New Folder</h5>
        Name: <input type="text" id="new-folder-name" required autofocus />
        <button onclick="Folder.addNewFolder();">Add</button>
        <button onclick="remove();">Cancel</button>
    </div>
}

